<!DOCTYPE html>
{% load static %}
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Summary List</title>
    <link rel="stylesheet" href="{% static 'css/navigation.css' %}">
    <style>
        :root {
            /* Brand Colors */
            --primary-color: #875a34;    /* Main brand color */
            --primary-light: #e99c59;   /* Lighter version for accents */
            --primary-dark: #6d4827;    /* Darker version for hover states */
            --secondary-color: #8c6e5d; /* Secondary brand color */
            
            /* Status Colors */
            --success-color: #34a853;   /* Green for success states */
            --warning-color: #fbbc05;   /* Yellow for warnings */
            --error-color: #ea4335;     /* Red for errors */
            --info-color: #4285f4;      /* Blue for information */
            
            /* Neutral Colors */
            --bg-color: #f4f7fc;        /* Light background */
            --text-dark: #333;          /* Dark text */
            --text-medium: #666;        /* Medium text */
            --text-light: #9e9e9e;      /* Light text */
            --white: #fff;              /* White */
        }
        
        body {
            font-family: 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background-color: var(--bg-color);
            margin: 0;
            padding: 20px;
            color: var(--text-dark);
        }
        
        .summary-box {
            padding: 15px;
            margin: 10px 0;
            border: 1px solid var(--text-light);
            border-radius: 8px;
            background-color: var(--white);
        }
        
        /* Highlight style */
        .highlight-hotel {
            background-color: rgba(52, 168, 83, 0.1); /* Light green with transparency */
            border: 2px solid var(--success-color);
        }
        
        .button {
            background-color: var(--primary-color);
            color: white;
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 8px;
            font-family: inherit;
            transition: background-color 0.2s;
        }
        
        .button:hover {
            background-color: var(--primary-dark);
        }
        
        h1 {
            color: var(--text-dark);
            margin-bottom: 20px;
        }
    </style>
    <!-- Include jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <div class="dashboard-container">
        <div class="navigation">
            {% include 'components/navigation.html' %}
        </div>
        <div class="content">
            <h1>Summary List</h1>
            {% for summary in summaries %}
                <div class="summary-box {% if summary.hotel == '1' %}highlight-hotel{% endif %}" id="summary-{{ summary.id }}">
                    <p><strong>{{ summary.accom_id.company_name }}</strong> | {{ summary.month_submitted }}</p>
                    <p>{{ summary.entry_ans|default:"No answer" }}</p>
                    <!-- Button to toggle hotel marking -->
                    <button type="button" class="button" onclick="markSummaryAsHotel('{{ summary.id }}')">
                        {% if summary.hotel == '1' %}Unmark as Hotel{% else %}Mark as Hotel{% endif %}
                    </button>
                </div>
            {% empty %}
                <p>No summary records found.</p>
            {% endfor %}
        </div>
    </div>

    <script>
        function markSummaryAsHotel(summaryId) {
            var summaryBox = document.getElementById("summary-" + summaryId);
            var newStatus;
            if (summaryBox.classList.contains("highlight-hotel")) {
                // Already highlighted, so unhighlight and set status to "0"
                summaryBox.classList.remove("highlight-hotel");
                newStatus = "0";
            } else {
                // Not highlighted, so highlight and set status to "1"
                summaryBox.classList.add("highlight-hotel");
                newStatus = "1";
            }
            $.ajax({
                type: "POST",
                url: "{% url 'admin_app:ajax_mark_summary_as_hotel' %}",
                data: {
                    summary_id: summaryId,
                    status: newStatus,
                    csrfmiddlewaretoken: "{{ csrf_token }}"
                },
                success: function(data) {
                    if (data.status !== "success") {
                        alert("Error: " + data.message);
                    }
                },
                error: function(xhr, status, error) {
                    alert("Error: " + error);
                }
            });
        }
        
        // Navigation responsive behavior
        document.addEventListener('DOMContentLoaded', function() {
            // Function to handle responsive navigation
            function handleResponsiveNavigation() {
                // Check if screen is mobile
                if (window.innerWidth <= 768) {
                    document.body.classList.add('mobile-view');
                    document.body.classList.remove('desktop-view');
                } else {
                    document.body.classList.add('desktop-view');
                    document.body.classList.remove('mobile-view');
                }
            }
            
            // Initial check
            handleResponsiveNavigation();
            
            // Add resize event listener
            window.addEventListener('resize', handleResponsiveNavigation);
            
            // Add scroll class when scrolling
            const navigation = document.querySelector('.navigation');
            window.addEventListener('scroll', function() {
                if (window.scrollY > 50) {
                    navigation.classList.add('scrolled');
                } else {
                    navigation.classList.remove('scrolled');
                }
            });
        });
    </script>
</body>
</html>